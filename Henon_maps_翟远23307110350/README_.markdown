# Hénon map绘制程序

## Hénon map的定义
数学上，[Hénon map](https://zh.wikipedia.org/wiki/%E5%8E%84%E5%86%9C%E6%98%A0%E5%B0%84)是一种位于离散时间上的动态系统。它是被广泛研究的代表[混沌现象](https://en.wikipedia.org/wiki/Chaos_theory)的动态系统之一。其迭代表达式为：
$$\begin{cases}
x_{n+1}=1-ax_n^2+y_n\\
y_{n+1}=bx_n
\end{cases}$$
该映射通过迭代产生轨迹。亦即，从一点 $u_0=(x_0,y_0)$开始代入上述表达式得到下一点坐标，如此迭代得到轨迹$[u_0,u_1,...,u_N]$

## 程序功能
本程序通过 python 编程实现以下功能：
1. 计算 Hénon map 的函数：对任意输入$a$、$b$、初始值$u_0$以及轨迹长度 $N$ ，输出厄农映射的轨迹$[u_0,u_1,...,u_N]$
2. 利用编写的函数计算经典 Hénon map 的轨迹: 固定参数值为 $a=1.4$, $b=0.3$, $u_0=(0, 0)$ 时，输入$N$值，得到轨迹图。（以 x 为横坐标， y 为纵坐标）
3. 利用编写的函数计算 Hénon map 的 orbit digram ，即固定 $b=0.3$ ，改变 $a$ 后获得⼀系列 Hénon map 的轨迹，然后以 $a$ 为横轴，$x$为纵轴绘制 orbit digram 图。
4. 分析上述画出的orbit digram，找到 Hénon map 可以收敛到⼀条周期性轨道的 $a$ 值，计算该 $a$ 值对应的 Hénon map 的轨迹并绘图。
## 解答思路
1. 基于迭代表达式利用循环结构计算 Hénon map 的函数
2. 基于 1 的代码，利用 matplotlib 作出轨迹图
3. 基于上述代码，利用嵌套循环结构作出不同 $a$ 值对应 $x$ 值的图
4. 基于 3 的代码，增加 $N$ 的大小作图，观察比较不同 $a$ 中，不重合的 $x$ 数据点数量的变换，其中数量不随 $N$ 增加的即为可能的 $a$ ；不断缩小 $a$ 的范围，得到收敛到周期性轨迹的 a 值为0.8975.
## 代码使用及结果示例
1.计算 Hénon map 函数的代码文件名为：[henon_map1.py](henon_map1.py)，通过输入任意输入 $a$、$b$、初始值 $u_0$ 以及轨迹长度 $N$ ，可输出厄农映射的轨迹 $[u_0,u_1,...,u_N]$ 。其中初始值 $u_0$ 的输入中应以空格隔开 $x$ 、 $y$ 坐标。

2.绘制经典 Hénon map 轨迹图的代码文件名为：[henon_map2.py](henon_map2.py), 通过输入 $N$ 值，即可得到轨迹图。
示例：
    $N$ =50时的轨迹图
    ![N=50时的轨迹图](2_N=50.png)
    $N$ =100时的轨迹图
    ![N=100时的轨迹图](2_N=100.png)
    $N$ =300时的轨迹图
    ![N=300时的轨迹图](2_N=300.png)
    $N$ =1000时的轨迹图
    ![N=1000时的轨迹图](2_N=1000.png)
   此外如下修改第18行代码，则可以绘制散点图
   ```python
        plt.scatter(x.y)
   ```
示例：
    $N$ =300时的散点图
    ![N=300时的散点图](2_N=300_scatter.png)
    $N$ =1000时的散点图
    ![N=1000时的散点图](2_N=1000_scatter.png)

3.绘制 Hénon map 的 orbit digram 的代码文件名为：[henon_map3.py](henon_map3.py)，通过输入 $a$ 的最大最小值及步长，以及 $N$ 值，即可得到 orbit digram 图。
示例：
   0.1≤ $a$ ≤1.5,步长0.1， $N$ =50
   ![0.1≤a≤1.5,步长0.1，N=50] (3_0.1-1.5_50.png)
   如需更细致观察点的重合情况，可修改第21行代码如下，改变 $s$ 的值即为调节绘制点的大小。
 
  ```python
        plt.scatter([a]*(N+1),x,s=1)
  ```
   0.10≤ $a$ ≤1.40,步长0.01， $N$ =100，$s$ =1
   ![alt text](3_0.1-1.4_0.01_100.png)
   0.10≤ $a$ ≤1.40,步长0.01， $N$ =1000，$s$ =1 
   ![alt text](3_0.1-1.4_0.01_1000.png)

4.观察上2张图，区间[0.4,1.2]可能存在所求 $a$ .利用3的代码，不断缩小 $a$ 的区间范围和步长，可得到使轨迹收敛到周期性轨迹的一个 $a$ 值，以此为参数作图的代码文件名为：[henon_map4.py](henon_map4.py)，得到结果如下：
   a=0.8975，N=100时的轨迹图
   ![alt text](4.png)
